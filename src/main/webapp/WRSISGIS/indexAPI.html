<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WRSIS Demo || Dynamic Layer using geoserver shape files</title>
    <link rel="stylesheet" href="WRSISGIS/css/bootstrap.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://openlayers.org/en/v4.6.5/css/ol.css" type="text/css">
    <link rel="stylesheet" href="WRSISGIS/css/icomoon.css">
    <link rel="stylesheet" href="WRSISGIS/css/style.css">

    <!-- The line below is only needed for old environments like Internet Explorer and Android 4.x -->
    <script
        src="https://cdn.polyfill.io/v2/polyfill.min.js?features=requestAnimationFrame,Element.prototype.classList,URL"></script>
    <script src="https://openlayers.org/en/v4.6.5/build/ol.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.min.js"></script>
    <script src="WRSISGIS/js/bootstrap.min.js"></script>
    <style>
        .disabled {
            pointer-events: none;
            cursor: not-allowed;
        }

        .activeIcon {
            background: #347696;
            text-decoration: none;
        }
    </style>

</head>

<body>
    <!-- <header>


        <div class="leftsec"><img src="image/logos.png"> </div>

        <div class="rightsec">
            <a href="javascript:void(0);" title='Show Timeline View'><img src="image/playTool.png" id='playTool'></a>
            <a href="javascript:void(0);" title='Change Basemap'><img src="image/basemap.png" id='baseMap'>
                <ul class='baseMapSublist'>
                    <li><input type='checkbox' name='osm' id='osm' checked disabled=true> &nbsp;Base Map</li>
                    <li><input type='checkbox' name='satellite' id='satellite'> &nbsp;Satellite Map</li>
                </ul>
            </a>
            <a href="javascript:void(0);" title='Rotate Map'><img src="image/output-onlinepngtools.png" id='rotate'></a>
            <a href="javascript:void(0);" title='Goto Home'><img src="image/home.png" id='home'></a>
            <a href="javascript:void(0);" title='Measurement'><img src="image/meserment.png" id='draw'></a>
            <a href="javascript:void(0);" title='Full Screen'><img src="image/full-screen.png" id='fullscreen'></a>
            <a href="javascript:void(0);" title='Overview Control'><img src="image/output-onlinepngtools1.png"
                    id='overview'></a>
            <a href="javascript:void(0);" title='Export PDF'><img src="image/pdf.png" id='exportPDF'></a>
            
        </div>
        <div class="clearfix"></div>
    </header> -->
    <header>


        <div class="leftsec"><img src="WRSISGIS/image/logo.png" alt="logo"><img src="WRSISGIS/image/Logos.png" alt="logo"> </div>

        <div class="rightsec">
            <a href="javascript:void(0);" title='Show Timeline View' id='playTool'>
                <!--<img src="image/playTool.png" id='playTool'>-->
                <span class="icon-Timeline_view"></span>
            </a>
            <a href="javascript:void(0);" title='Change Basemap' id='baseMap'>
                <!-- <img src="image/basemap.png" id='baseMap'>-->
                <span class="icon-Basemap"></span>
                <ul class='baseMapSublist'>
                    <li><input type='checkbox' name='osm' id='osm' checked disabled=true> <label for='osm'><img
                                src="WRSISGIS/image/streetmap.png" alt="logo" width='100px'></label></li>
                    <li><input type='checkbox' name='satellite' id='satellite'> <label for='satellite'><img
                                src="WRSISGIS/image/satelitemap.png" alt="logo" width='100px'></label></li>
                </ul>
            </a>
            <a href="javascript:void(0);" title='Rotate Map' id='rotate'>
                <!--<img src="image/output-onlinepngtools.png" id='rotate'>-->
                <span class="icon-Rotate_map"></span>

            </a>
            <a href="javascript:void(0);" title='Go to Home' id='home'>
                <!--<img src="image/home.png" id='home'>-->
                <span class="icon-Home"></span>
            </a>
            <a href="javascript:void(0);" title='Measurement' id='draw'>
                <!--<img src="image/meserment.png" id='draw'>-->
                <span class="icon-measurement"></span>
            </a>
            <a href="javascript:void(0);" title='Draw on Map' id='drawMark'>
                <!--<img src="image/meserment.png" id='draw'>-->
                <span class=""><i class="fa fa-pencil " aria-hidden="true"></i></span>
            </a>
            <a href="javascript:void(0);" title='Full Screen' id='fullscreen'>
                <!--<img src="image/full-screen.png" id='fullscreen'>-->
                <span class="icon-Full_scrren"></span>
            </a>
            <a href="javascript:void(0);" title='Overview Control' id='overview'>
                <!--<img src="image/output-onlinepngtools1.png"  id='overview'>-->
                <span class="icon-Overview_control"></span>
            </a>
            <a href="javascript:void(0);" title='Export PDF' id='exportPDF'>
                <!--<img src="image/pdf.png" id='exportPDF'>-->
                <span class="icon-PDF"></span>
            </a>
            <a href="javascript:void(0);" title='Print' data-toggle="modal" data-target="#printmodal">
                <span class="icon-Print"></span>
            </a>
        </div>
        <div class="clearfix"></div>
    </header>

    <div class="clearfix"></div>
    <div class='container'>
        <div id="map">
            <!-- <div class='loaderBox'>
                <img src="image/Logos.png" height='10px'>
            </div> -->
            <div class="description"> Lorem Ipsum is simply dummy text of the printing and typesetting industry </div>

            <div class="selectBox1">
                <button id='pauseBtn' class="buttons" title='play/pause'><i class="fa fa-pause"
                        aria-hidden="true"></i></button> <br>
                <button id='clrBtn' class="buttons" title='stop'><i class="fa fa-stop" aria-hidden="true"></i></button>
            </div>


        </div>
        <div class='sidemenu'>
            <div class='parent'>
                <label for='week'>Select Rust Type :</label>
                <div class='selectBox'>
                    <select id='rustType'>
                        <option value=''>--Select Rust--</option>
                        <option value='leafRust' selected>Leaf rust</option>
                        <option value='steamRust'>Stem rust</option>
                        <option value='yellowRust'>Yellow rust</option>
                    </select>
                </div>
            </div>


            <label class="heading">Map Type :</label>



            <div class="legend">
                <div class="accordion" id="accordionExample">
                    <div class="card">
                        <div class="card-head" id="headingOne">
                            <h2 class="mb-0" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true"
                                aria-controls="collapseOne">
                                <input type='radio' name='layerType' id='Deposition' value="deposition" checked
                                    style="margin: 5px 0px 10px 15px;"><strong> Deposition</strong><br>
                            </h2>
                        </div>

                        <div id="collapseOne" class="collapse show" aria-labelledby="headingOne"
                            data-parent="#accordionExample">
                            <div class="card-body">


                                <div class="checkbox" id='none'>
                                    <input id="checkbox1" class='depositionChkBox' type="checkbox" value='none/trace'>
                                    <label for="checkbox1">None/Trace (0 - 10)</label>
                                </div>

                                <div class="checkbox" id='low'>
                                    <input id="checkbox1" class='depositionChkBox' type="checkbox" value='low'>
                                    <label for="checkbox1">Low (10 - 1e+6)</label>
                                </div>

                                <div class="checkbox" id='medium'>
                                    <input id="checkbox1" class='depositionChkBox' type="checkbox" value='moderate'>
                                    <label for="checkbox1">Moderate (1e+6 - 1e+8)</label>
                                </div>

                                <div class="checkbox" id='high'>
                                    <input id="checkbox1" class='depositionChkBox' type="checkbox" value='high'>
                                    <label for="checkbox1">High (1e+8 - 1e+11)</label>
                                </div>

                                <div class="checkbox" id='veryHigh'>
                                    <input id="checkbox1" class='depositionChkBox' type="checkbox" value='very high'>
                                    <label for="checkbox1">Very High (1e+11 -)</label>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-head" id="headingTwo">
                            <h2 class="mb-0 collapsed" data-toggle="collapse" data-target="#collapseTwo"
                                aria-expanded="false" aria-controls="collapseTwo">
                                <input type='radio' name='layerType' id='Environment' value="environment"
                                    style="margin: 5px 0px 10px 15px;"><strong> Suitability</strong><br>
                            </h2>
                        </div>
                        <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo"
                            data-parent="#accordionExample">
                            <div class="card-body">
                                <div class="checkbox" id='none'>
                                    <input id="checkbox12" class='environmentChkBox' type="checkbox" value='no'>
                                    <label for="checkbox12">None/Trace (0%)</label>
                                </div>

                                <div class="checkbox" id='low'>
                                    <input id="checkbox13" class='environmentChkBox' type="checkbox" value='low'>
                                    <label for="checkbox13">Low (0% - 10.5%)</label>
                                </div>

                                <div class="checkbox" id='medium'>
                                    <input id="checkbox14" class='environmentChkBox' type="checkbox" value='moderate'>
                                    <label for="checkbox14">Moderate (10.5% - 21%)</label>
                                </div>

                                <div class="checkbox" id='high'>
                                    <input id="checkbox15" class='environmentChkBox' type="checkbox" value='high'>
                                    <label for="checkbox15">High (21% - 31.5%)</label>
                                </div>

                                <div class="checkbox" id='veryHigh'>
                                    <input id="checkbox16" class='environmentChkBox' type="checkbox" value='very high'>
                                    <label for="checkbox16">Very High (31.5% - 42.1%)</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- 
            <div class='parent'>
                <label>Survey legend :</label>
                <div class='selectBox'>

                    <div class="marker">
                        <p><i class="fa fa-map-marker" aria-hidden="true" style="color:#22af4b;"></i><span> None/Trace
                            </span></p>
                        <p><i class="fa fa-map-marker" aria-hidden="true" style="color:#00a2e8;"></i><span> Low(0)
                            </span></p>
                        <p><i class="fa fa-map-marker" aria-hidden="true" style="color:#fb7e2a;"></i><span> Moderate
                            </span></p>
                        <p><i class="fa fa-map-marker" aria-hidden="true" style="color:#ed1c24;"></i><span> High </span>
                        </p>

                    </div>

                </div>
            </div> -->





            <!-- <div class='selectButton'>
                <button type='button' id='submit'>Show Map</button>
            </div> -->

            <br><br><br><br>
            <!--<div class="parent">
                <label>Transition : </label>
                <div class="selectBox1">
                    <button id='pauseBtn' class="buttons"><i class="fa fa-pause" aria-hidden="true"></i></button>&nbsp;&nbsp;
                    <button id='clrBtn' class="buttons"><i class="fa fa-play" aria-hidden="true"></i></button>
                </div>
            </div>-->
            <a href='https://doi.org/10.1088/1748-9326/ab4034' target="_blank" style='font-size:medium;'>Wheat Rust Early Warning System description</a>

        </div>

        <div class="clearfix"></div>
    </div>
    <div id="alertModal" class="modal3">

        <!-- Modal content -->
        <div class="modal-content3">
            <div class="modal-header3">
                <span class="close3">&times;</span>
            </div>
            <div>
                <div class="modal-body3">
                    <h4>Want to play Timeline View</h4>
                </div>
            </div>
            <div class="modal-footer3">
                <button id="modalConfirm">Play Now</button>
                <button id="modalClose">Cancel</button>
            </div>
        </div>

    </div>
    <footer>
        <p>Copyright Â©2020 WRSIS. All Rights Reserved</p>
        <div class="clearfix"></div>
    </footer>
    <!-- <footer></footer> -->

    <!--popup content-->
    <div id="popup" class="ol-popup">
        <a href="#" id="popup-closer" class="ol-popup-closer"></a>
        <div id="popup-content"></div>
    </div>

    <!-- Print Modal popup-->
    <div class="modal fade" id="printmodal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modalprint-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="exampleModalCenterTitle">Incident Rust Survey Detail on Map </h4>
                    <div class="text-right float-right">

                        <a id="downloadMap" href="#"><button type="button" class="btn btn-success">Save Map</button></a>
                        <button type="button" class="close " data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>


                </div>
                <div class="modal-body">
                    <div class="row mapPngContainer">
                        <div class="col-sm-8">
                            <!-- <img src="image/print-popup-img.jpg" class="img-fluid w-100" /> -->
                            <div class="mapPng" style='height:800px;height:90vh;'></div>
                        </div>
                        <div class="col-sm-4" style='background-color:rgba(255,255,255,0.7);height:35vh;'>
                            <h4> Deposition</h4>
                            <div class="checkbox" id="none">
                                <!-- <input id="checkbox1" class="depositionChkBox" type="checkbox" value="none/trace"> -->
                                <label for="checkbox1" class='legendList1'>None/Trace (0 - 10)</label>
                            </div>

                            <div class="checkbox" id="low">
                                <!-- <input id="checkbox1" class="depositionChkBox" type="checkbox" value="low"> -->
                                <label for="checkbox1" class='legendList2'>Low (10 - 1e+06)</label>
                            </div>

                            <div class="checkbox" id="medium">
                                <!-- <input id="checkbox1" class="depositionChkBox" type="checkbox" value="moderate"> -->
                                <label for="checkbox1" class='legendList3'>Moderate (1e+06 - 1e+08)</label>
                            </div>

                            <div class="checkbox" id="high">
                                <!-- <input id="checkbox1" class="depositionChkBox" type="checkbox" value="high"> -->
                                <label for="checkbox1" class='legendList4'>High (1e+08 - 1e+11)</label>
                            </div>

                            <div class="checkbox" id="veryHigh">
                                <!-- <input id="checkbox1" class="depositionChkBox" type="checkbox" value="very high"> -->
                                <label for="checkbox1" class='legendList5'>Very High (1e+11 -)</label>
                            </div>

                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!-- Print Modal popup-->






    <script>
        /***************Popup Configuration*************/
        /**
      * Elements that make up the popup.
      */
        var container = document.getElementById('popup');
        var content = document.getElementById('popup-content');
        var closer = document.getElementById('popup-closer');


        /**
         * Create an overlay to anchor the popup to the map.
         */
        var overlay = new ol.Overlay({
            element: container,
            autoPan: true,
            autoPanAnimation: {
                duration: 250
            }
        });


        /**
         * Add a click handler to hide the popup.
  
         */
        closer.onclick = function () {
            overlay.setPosition(undefined);
            closer.blur();
            return false;
        };
        /***************Popup Configuration*************/




        /*************Base Source and Base Layer of the Map*******************/
        var baseSource = new ol.source.OSM();
        var baseLayer = new ol.layer.Tile({
            source: baseSource
        });

        var boundaryLayer = new ol.layer.Image({
            source: new ol.source.ImageWMS({
                url: 'http://117.247.252.238:8080/geoserver/wms',
                params: { 'LAYERS': 'ETH_SCHOOL:Ethiopia' },
                serverType: "geoserver",
                crossOrigin: 'anonymous'
            })
        });






        /*************Initializing Map*******************/
        var latestLayer;
        var map = new ol.Map({
            layers: [baseLayer],
            target: 'map',
            overlays: [overlay],
            view: new ol.View({
                center: new ol.proj.fromLonLat([40.4897, 9.1450]),
                zoom: 6,
                maxZoom: 15
            })
        });


        /**************Adding scaleline control for map****************/
        var scaleLineControl = new ol.control.ScaleLine();
        map.addControl(scaleLineControl);





        $(document).ready(function () {
            $(".baseMapSublist").hide();
            var settings = {
                "url": "gisapi/getMasterDataForGISMap",
                "method": "POST",
                "timeout": 0,
            };

            $.ajax(settings).done(function (response) {
                var response = JSON.parse(response);
                if (response.status == 200) {
                    var rustData = response.response.diseaseData;
                    var mapData = response.response.mapTypeData;
                    $("#rustType").html('');
                    for (var i = 0; i < rustData.length; i++) {
                        $("#rustType").append('<option value="' + rustData[i].rustId + '">' + rustData[i].rustName + '</option>');
                    }
                    // console.log(mapData)
                    for (var i = 0; i < mapData.length; i++) {
                        if (mapData[i].mapName == "Deposition") {
                            $("#Deposition").val(mapData[i].mapId);
                        } else {
                            $("#Environment").val(mapData[i].mapId);
                        }
                    }

                    getLatestLayer();
                }
            });
        });

        $('#rustType').change(function () {
            getLatestLayer();
        });


        /*******Fetching Latest Layer and creating Layer****************/
        var filterQry = "";
        var wmsSource;
        var latestLayerName;
        function getLatestLayer() {
            /**remove popup*/
            overlay.setPosition(undefined)
            closer.blur();
            map.removeLayer(latestLayer);
            /**remove popup*/
            var rustType = $('#rustType').val();
            var layerType = $("input[name='layerType']:checked").val();
            filterQry = "";
            if (layerType == '1') {
                $(".depositionChkBox").each(function () {
                    if ($(this).is(":checked")) {
                        if (filterQry == "") {
                            filterQry = "'" + $(this).val() + "'";
                        } else {
                            filterQry += ",'" + $(this).val() + "'";
                        }
                    }
                });
                if (filterQry == "") {
                    filterQry = "'none/trace','low','moderate','high','very high'";
                }
            } else {
                $(".environmentChkBox").each(function () {
                    if ($(this).is(":checked")) {
                        if (filterQry == "") {
                            filterQry = "'" + $(this).val() + "'";
                        } else {
                            filterQry += ",'" + $(this).val() + "'";
                        }
                    }
                });
                if (filterQry == "") {
                    filterQry = "'no','low','moderate','high','very high'";
                }
            }

            // for (var l = 0; l < resObj.length; l++) {
            //     if (resObj[l].layerType == layerType && resObj[l].rustType == rustType) {
            //         wmsSource = new ol.source.ImageWMS({
            //             url: 'http://117.247.252.238:8080/geoserver/wms',
            //             params: { 'LAYERS': resObj[l].wsName + ':' + resObj[l].layerName, "CQL_FILTER": "Category IN(" + filterQry + ")" },
            //             serverType: "geoserver",
            //             crossOrigin: 'anonymous'
            //         });
            //         latestLayer = new ol.layer.Image({
            //             source: wmsSource
            //         });
            //     }
            // }


            var settings = {
                "url": "gisapi/getLatestGISData",
                "method": "POST",
                "timeout": 0,
                "headers": {
                    "Content-Type": "application/json"
                },
                "data": JSON.stringify({ "disease": rustType, "mapTypeId": layerType }),
            };
            $.ajax(settings).done(function (response) {
                var response = JSON.parse(response);
                if (response.status == 200) {
                    if (response.response.gisLatestData != '') {
                        latestLayerName = response.response.gisLatestData[0].layerName;
                        // console.log(latestLayerName)
                        wmsSource = new ol.source.ImageWMS({
                            url: 'http://117.247.252.238:8080/geoserver/wms',
                            params: { 'LAYERS': 'WRSIS:' + latestLayerName, "CQL_FILTER": "Category IN(" + filterQry + ")" },
                            serverType: "geoserver",
                            crossOrigin: 'anonymous'
                        });
                        latestLayer = new ol.layer.Image({
                            source: wmsSource
                        });

                        map.addLayer(latestLayer);
                    }
                }
            });


            map.removeLayer(boundaryLayer);
            map.addLayer(boundaryLayer);
            getHistoryLayer(rustType, layerType, filterQry);

            if(drawMode==1){
                map.removeLayer(drawingLayer)
                map.addLayer(drawingLayer)
            }
        }

        $(".environmentChkBox").change(function () {
            if ($("#Environment").is(":checked")) {
                var rustType = $('#rustType').val();
                var layerType = $("input[name='layerType']:checked").val();
                filterQry = "";
                $(".environmentChkBox").each(function () {
                    if ($(this).is(":checked")) {
                        if (filterQry == "") {
                            filterQry = "'" + $(this).val() + "'";
                        } else {
                            filterQry += ",'" + $(this).val() + "'";
                        }
                    }
                });
                if (filterQry == "") {
                    filterQry = "'no','low','moderate','high','very high'";
                }

                // for (var l = 0; l < resObj.length; l++) {
                //     if (resObj[l].layerType == layerType && resObj[l].rustType == rustType) {
                //         wmsSource = new ol.source.ImageWMS({
                //             url: 'http://117.247.252.238:8080/geoserver/wms',
                //             params: { 'LAYERS': resObj[l].wsName + ':' + resObj[l].layerName, "CQL_FILTER": "Category IN(" + filterQry + ")" },
                //             serverType: "geoserver",
                //             crossOrigin: 'anonymous'
                //         });
                //         latestLayer.setSource(null);
                //         latestLayer.setSource(wmsSource);
                //     }
                // }

                // var settings = {
                //     "url": "http://192.168.103.224:8086/gisapi/getLatestGISData",
                //     "method": "POST",
                //     "timeout": 0,
                //     "headers": {
                //         "Content-Type": "application/json"
                //     },
                //     "data": JSON.stringify({ "disease": rustType, "mapTypeId": layerType }),
                // };
                // $.ajax(settings).done(function (response) {
                //     var response = JSON.parse(response);
                //     if (response.status == 200) {
                //         if (response.response.gisLatestData != '') {
                //             var latestLayerName = response.response.gisLatestData[0].layerName;
                //             console.log(latestLayerName)
                //             wmsSource = new ol.source.ImageWMS({
                //                 url: 'http://117.247.252.238:8080/geoserver/wms',
                //                 params: { 'LAYERS': 'WRSIS:' + latestLayerName, "CQL_FILTER": "Category IN(" + filterQry + ")" },
                //                 serverType: "geoserver",
                //                 crossOrigin: 'anonymous'
                //             });
                //             latestLayer.setSource(null);
                //             latestLayer.setSource(wmsSource);
                //             getHistoryLayer(rustType, layerType, filterQry);
                //         }
                //     }

                // });
                wmsSource = new ol.source.ImageWMS({
                    url: 'http://117.247.252.238:8080/geoserver/wms',
                    params: { 'LAYERS': 'WRSIS:' + latestLayerName, "CQL_FILTER": "Category IN(" + filterQry + ")" },
                    serverType: "geoserver",
                    crossOrigin: 'anonymous'
                });
                latestLayer.setSource(null);
                latestLayer.setSource(wmsSource);
                getHistoryLayer(rustType, layerType, filterQry);
            }
        });

        $(".depositionChkBox").change(function () {
            if ($("#Deposition").is(":checked")) {
                var rustType = $('#rustType').val();
                var layerType = $("input[name='layerType']:checked").val();
                filterQry = "";
                $(".depositionChkBox").each(function () {
                    if ($(this).is(":checked")) {
                        if (filterQry == "") {
                            filterQry = "'" + $(this).val() + "'";
                        } else {
                            filterQry += ",'" + $(this).val() + "'";
                        }
                    }
                });
                if (filterQry == "") {
                    filterQry = "'none/trace','low','moderate','high','very high'";
                }

                // for (var l = 0; l < resObj.length; l++) {
                //     if (resObj[l].layerType == layerType && resObj[l].rustType == rustType) {
                //         wmsSource = new ol.source.ImageWMS({
                //             url: 'http://117.247.252.238:8080/geoserver/wms',
                //             params: { 'LAYERS': resObj[l].wsName + ':' + resObj[l].layerName, "CQL_FILTER": "Category IN(" + filterQry + ")" },
                //             serverType: "geoserver",
                //             crossOrigin: 'anonymous'
                //         });
                //         latestLayer.setSource(null);
                //         latestLayer.setSource(wmsSource);
                //     }
                // }


                // var settings = {
                //     "url": "http://192.168.103.224:8086/gisapi/getLatestGISData",
                //     "method": "POST",
                //     "timeout": 0,
                //     "headers": {
                //         "Content-Type": "application/json"
                //     },
                //     "data": JSON.stringify({ "disease": rustType, "mapTypeId": layerType }),
                // };
                // $.ajax(settings).done(function (response) {
                //     var response = JSON.parse(response);
                //     if (response.status == 200) {
                //         if (response.response.gisLatestData != '') {
                //             var latestLayerName = response.response.gisLatestData[0].layerName;
                //             console.log(latestLayerName)
                //             wmsSource = new ol.source.ImageWMS({
                //                 url: 'http://10.1.2.96:8080/geoserver/wms',
                //                 params: { 'LAYERS': 'WRSIS:' + latestLayerName, "CQL_FILTER": "Category IN(" + filterQry + ")" },
                //                 serverType: "geoserver",
                //                 crossOrigin: 'anonymous'
                //             });
                //             latestLayer.setSource(null);
                //             latestLayer.setSource(wmsSource);
                //             getHistoryLayer(rustType, layerType, filterQry);
                //         }
                //     }
                // });
                wmsSource = new ol.source.ImageWMS({
                    url: 'http://10.1.2.96:8080/geoserver/wms',
                    params: { 'LAYERS': 'WRSIS:' + latestLayerName, "CQL_FILTER": "Category IN(" + filterQry + ")" },
                    serverType: "geoserver",
                    crossOrigin: 'anonymous'
                });
                latestLayer.setSource(null);
                latestLayer.setSource(wmsSource);
                getHistoryLayer(rustType, layerType, filterQry);
            }
        });








        /**************Show latest Layer upon clicking on show map Button***********************/
        $("#Deposition, #Environment").click(function () {
            $(".baseMapSublist").hide();
            getLatestLayer();

            if(drawMode==1){
                map.removeLayer(drawingLayer)
                map.addLayer(drawingLayer)
            }
        });

        var modal3 = document.getElementById("alertModal");
        $(".close3").click(function () {
            modal3.style.display = "none";
        });
        $("#modalClose").click(function () {
            modal3.style.display = "none";
        });
        window.onclick = function (event) {
            if (event.target == modal3) {
                modal3.style.display = "none";
            }
        }


        var arrayLayer = [];
        function getHistoryLayer(rustType, layerType, filterQry) {
            var settings = {
                "url": "gisapi/getGISHistoryData",
                "method": "POST",
                "timeout": 0,
                "headers": {
                    "Content-Type": "application/json"
                },
                "data": JSON.stringify({ "disease": rustType, "mapTypeId": layerType }),
            };

            $.ajax(settings).done(function (response) {
                var response = JSON.parse(response);
                arrayLayer = [];
                if (response.status == 200) {
                    if (response.response.gisHistoryData != '') {
                        var resData = response.response.gisHistoryData;
                        for (var i = 0; i < resData.length; i++) {
                            var layer = new ol.layer.Image({
                                source: new ol.source.ImageWMS({
                                    url: 'http://192.168.103.224:8080/geoserver/wms',
                                    params: { 'LAYERS': 'WRSIS:' + resData[i].layerName/*,"CQL_FILTER":"Category IN("+filterQry+")" */ },
                                    serverType: "geoserver",
                                    crossOrigin: 'anonymous'
                                })
                            });
                            arrayLayer.push(layer);
                        }
                    }
                }
            });
        }




        /**************TimeLine View***********************/
        $("#playTool").click(function () {
            $("#alertModal").show();
        });
        // var confirm = window.confirm('Click Ok to Play timeline View');
        $("#modalConfirm").click(function () {
            $("#alertModal").hide();
            $(".description").show();
            $('.selectBox1').show();
            setIconMode(0);
            pauseBtn.disabled = false;
            clrBtn.disabled = false;
            map.removeLayer(latestLayer);
            // arrayLayer = [];
            // for (var i = 0; i < resObjHistory.length; i++) {
            //     var layer = new ol.layer.Image({
            //         source: new ol.source.ImageWMS({
            //             url: 'http://117.247.252.238:8080/geoserver/wms',
            //             params: { 'LAYERS': resObjHistory[i].wsName + ':' + resObjHistory[i].layerName/*,"CQL_FILTER":"Category IN("+filterQry+")" */ },
            //             serverType: "geoserver",
            //             crossOrigin: 'anonymous'
            //         })
            //     });
            //     arrayLayer.push(layer);
            // }
            playTimelineView();

        });


        /********************Show Timeline view********************/
        function playTimelineView() {
            i = 0;
            opacityValue = 0.001;
            map.removeLayer(arrayLayer[0])
            map.addLayer(arrayLayer[0])
            map.removeLayer(boundaryLayer);
            map.addLayer(boundaryLayer);
            $('.description').html(arrayLayer[0].getSource().a.LAYERS.split(':')[1]);
            fadeIn();
        }
        var opacityValue = 0.001;
        var i = 0;
        var timeoutId;
        function fadeIn() {
            arrayLayer[i].setOpacity(opacityValue);
            if (opacityValue < 1) {
                opacityValue += 0.001;
                timeoutId = setTimeout(fadeIn, .05);
            } else {
                opacityValue = 0.001;
                i++;
                if (i < arrayLayer.length - 1) {
                    arrayLayer[i].setOpacity(0.0);
                    map.removeLayer(arrayLayer[i]);
                    map.addLayer(arrayLayer[i]);
                    $('.description').html(arrayLayer[i].getSource().a.LAYERS.split(':')[1])
                    map.removeLayer(boundaryLayer);
                    map.addLayer(boundaryLayer);
                    if (i < arrayLayer.length - 1) {
                        fadeIn();
                    }
                } else {
                    playTimelineView();
                }
            }
        }


        var status = 1;
        var pauseBtn = document.getElementById('pauseBtn');
        pauseBtn.addEventListener('click', function () {
            status++;
            $("#pauseBtn i").toggleClass('fa fa-pause fa fa-play');
            if (status % 2 == 0) {
                clearTimeout(timeoutId);
            } else {
                fadeIn();
            }
        });

        var clrBtn = document.getElementById('clrBtn');
        clrBtn.addEventListener('click', function () {
            $('.description').hide();
            $('.selectBox1').hide();
            pauseBtn.disabled = true;
            clrBtn.disabled = true;
            setIconMode(1);
            clearTimeout(timeoutId);
            status = 1;
            for (var i = 0; i < arrayLayer.length - 1; i++) {
                map.removeLayer(arrayLayer[i]);
            }
            getLatestLayer();
        });


        /**************Base Map Changing function************/

        $("#baseMap").click(function () {
            $(".baseMapSublist").toggle();
        });

        $("#osm").click(function () {
            $("#satellite").prop("checked", false);
            $("#satellite").attr('disabled', false);
            $("#osm").attr('disabled', true);
            var baseSource = new ol.source.OSM();
            baseLayer.setSource(baseSource);
        });

        $("#satellite").click(function () {
            $("#osm").prop("checked", false);
            $("#osm").attr('disabled', false);
            $("#satellite").attr('disabled', true);
            var baseSource = new ol.source.BingMaps({
                key:
                    "AhwEak-Pn6513R37o8zqIfN3HutOSk38RYKI5HGCg-lpYFfCwdGQM0d9i4GNgtlJ",
                imagerySet: "AerialWithLabels"
            });
            baseLayer.setSource(baseSource);
        });


        /********Zoom to center*************/
        $("#home").click(function () {
            map.getView().animate({
                zoom: 6,
                duration: 2000,
                center: new ol.proj.fromLonLat([40.4897, 9.1450])
            });
        });


        /********Full Screen Control***************/
        $("#fullscreen").click(function () {
            openFullscreen();
        });
        var elem = document.getElementById("map");
        function openFullscreen() {
            if (elem.requestFullscreen) {
                elem.requestFullscreen();
            } else if (elem.mozRequestFullScreen) {
                /* Firefox */
                elem.mozRequestFullScreen();
            } else if (elem.webkitRequestFullscreen) {
                /* Chrome, Safari and Opera */
                elem.webkitRequestFullscreen();
            } else if (elem.msRequestFullscreen) {
                /* IE/Edge */
                elem.msRequestFullscreen();
            }
        }


        /****ADDING MEASUREMENT TOOL****/
        var measurementVal = 1;
        $("#draw").click(function () {
            if (measurementVal == 1) {
                map.addLayer(vectorDraw);
                addInteraction();
                measurementVal = 2;
            } else {
                //measurementVal = 1
                clearDraw();
            }
        });


        var sourceDraw = new ol.source.Vector();
        var vectorDraw = new ol.layer.Vector({
            source: sourceDraw,
            style: new ol.style.Style({
                fill: new ol.style.Fill({
                    color: "rgba(255, 255, 255, 0.2)"
                }),
                stroke: new ol.style.Stroke({
                    color: "#ffcc33",
                    width: 2
                }),
                image: new ol.style.Circle({
                    radius: 7,
                    fill: new ol.style.Fill({
                        color: "#ffcc33"
                    })
                })
            })
        });

        /**
         * Currently drawn feature.
         * @type {ol.Feature}
         */
        var sketch;

        /**
         * The help tooltip element.
         * @type {Element}
         */
        var helpTooltipElement;

        /**
         * Overlay to show the help messages.
         * @type {ol.Overlay}
         */
        var helpTooltip;

        /**
         * The measure tooltip element.
         * @type {Element}
         */
        var measureTooltipElement;

        /**
         * Overlay to show the measurement.
         * @type {ol.Overlay}
         */
        var measureTooltip;


        var draw; // global so we can remove it later

        function addInteraction() {
            /**
             * Message to show when the user is drawing a line.
             * @type {string}
             */
            var continueLineMsg = "Click to continue drawing the line";
            var type = "LineString";
            draw = new ol.interaction.Draw({
                source: sourceDraw,
                type: type,
                style: new ol.style.Style({
                    fill: new ol.style.Fill({
                        color: "rgba(255, 255, 255, 0.2)"
                    }),
                    stroke: new ol.style.Stroke({
                        color: "rgba(0, 0, 0, 0.5)",
                        lineDash: [10, 10],
                        width: 2
                    }),
                    image: new ol.style.Circle({
                        radius: 5,
                        stroke: new ol.style.Stroke({
                            color: "rgba(0, 0, 0, 0.7)"
                        }),
                        fill: new ol.style.Fill({
                            color: "rgba(255, 255, 255, 0.2)"
                        })
                    })
                })
            });
            map.addInteraction(draw);

            createMeasureTooltip();
            createHelpTooltip();

            var listener;
            draw.on(
                "drawstart",
                function (evt) {
                    // set sketch
                    sketch = evt.feature;

                    /** @type {ol.Coordinate|undefined} */
                    var tooltipCoord = evt.coordinate;

                    listener = sketch.getGeometry().on("change", function (evt) {
                        var geom = evt.target;
                        var output;
                        output = formatLength(geom);
                        //console.log(output)
                        tooltipCoord = geom.getLastCoordinate();
                        measureTooltipElement.innerHTML = output;
                        measureTooltip.setPosition(tooltipCoord);
                    });
                },
                this
            );

            draw.on(
                "drawend",
                function (e) {
                    measureTooltipElement.className = "tooltip tooltip-static";
                    measureTooltip.setOffset([0, -7]);
                    // unset sketch
                    sketch = null;
                    // unset tooltip so that a new one can be created
                    measureTooltipElement = null;
                    createMeasureTooltip();
                    ol.Observable.unByKey(listener);
                },
                this
            );

            /**
             * Creates a new help tooltip
             */
            function createHelpTooltip() {
                if (helpTooltipElement) {
                    helpTooltipElement.parentNode.removeChild(helpTooltipElement);
                }
                helpTooltipElement = document.createElement("div");
                helpTooltipElement.className = "tooltip hidden";
                helpTooltip = new ol.Overlay({
                    element: helpTooltipElement,
                    offset: [15, 0],
                    positioning: "center-left"
                });
                map.addOverlay(helpTooltip);
            }

            /**
             * Creates a new measure tooltip
             */
            function createMeasureTooltip() {
                if (measureTooltipElement) {
                    measureTooltipElement.parentNode.removeChild(measureTooltipElement);
                }
                measureTooltipElement = document.createElement("div");
                measureTooltipElement.className = "tooltip tooltip-measure";
                measureTooltip = new ol.Overlay({
                    element: measureTooltipElement,
                    offset: [0, -15],
                    positioning: "bottom-center"
                });
                map.addOverlay(measureTooltip);
            }

            var pointerMoveHandler = function (evt) {
                if (evt.dragging) {
                    return;
                }
                /** @type {string} */
                var helpMsg = "Click to start drawing";

                if (sketch) {
                    var geom = sketch.getGeometry();
                    if (geom instanceof ol.geom.Polygon) {
                        helpMsg = continuePolygonMsg;
                    } else if (geom instanceof ol.geom.LineString) {
                        helpMsg = continueLineMsg;
                    }
                }
                //console.log(helpMsg)
                helpTooltipElement.innerHTML = helpMsg;

                helpTooltip.setPosition(evt.coordinate);

                helpTooltipElement.classList.remove("hidden");
            };
            map.on("pointermove", pointerMoveHandler);

            map.getViewport().addEventListener("mouseout", function () {
                helpTooltipElement.classList.add("hidden");
            });

            var typeSelect = document.getElementById("type");

            /**
             * Format length output.
             * @param {ol.geom.LineString} line The line.
             * @return {string} The formatted length.
             */
            var formatLength = function (line) {
                var length = ol.Sphere.getLength(line);
                var output;
                if (length > 100) {
                    output = Math.round((length / 1000) * 100) / 100 + " " + "km";
                } else {
                    output = Math.round(length * 100) / 100 + " " + "m";
                }
                return output;
            };

            /**
             * Format area output.
             * @param {ol.geom.Polygon} polygon The polygon.
             * @return {string} Formatted area.
             */
            var formatArea = function (polygon) {
                var area = ol.Sphere.getArea(polygon);
                var output;
                if (area > 10000) {
                    output =
                        Math.round((area / 1000000) * 100) / 100 + " " + "km<sup>2</sup>";
                } else {
                    output = Math.round(area * 100) / 100 + " " + "m<sup>2</sup>";
                }
                return output;
            };
        }

        function clearDraw() {//Function to clear the draw
            measurementVal = 1;
            map.removeInteraction(draw);
            map.removeLayer(vectorDraw);
            sourceDraw.clear();
            map.removeOverlay(helpTooltip);
            map.removeOverlay(measureTooltip);
            $('.ol-overlay-container').find('.tooltip-static').hide()
        }


        /********EXPORT PDF***********************/
        var dims = {
            a0: [1189, 841],
            a1: [841, 594],
            a2: [594, 420],
            a3: [420, 297],
            a4: [297, 210],
            a5: [210, 148]
        };
        var loading = 0;
        var loaded = 0;

        var exportButton = document.getElementById("exportPDF");

        exportButton.addEventListener(
            "click",
            function () {
                exportButton.disabled = true;
                document.body.style.cursor = "progress";

                var format = "a4";
                var resolution = '120';
                var dim = dims[format];
                var width = Math.round((dim[0] * resolution) / 25.4);
                var height = Math.round((dim[1] * resolution) / 25.4);
                var size = /** @type {ol.Size} */ (map.getSize());
                var extent = map.getView().calculateExtent(size);

                var source = baseLayer.getSource();

                var tileLoadStart = function () {
                    ++loading;
                };

                var tileLoadEnd = function () {
                    ++loaded;
                    if (loading === loaded) {
                        var canvas = this;
                        window.setTimeout(function () {
                            loading = 0;
                            loaded = 0;
                            var data = canvas.toDataURL("image/png");
                            var pdf = new jsPDF("landscape", undefined, format);
                            pdf.addImage(data, "JPEG", 0, 0, dim[0], dim[1]);
                            pdf.save("map.pdf");
                            source.un("tileloadstart", tileLoadStart);
                            source.un("tileloadend", tileLoadEnd, canvas);
                            source.un("tileloaderror", tileLoadEnd, canvas);
                            map.setSize(size);
                            map.getView().fit(extent);
                            map.renderSync();
                            exportButton.disabled = false;
                            document.body.style.cursor = "auto";
                        }, 100);
                    }
                };

                map.once("postcompose", function (event) {
                    source.on("tileloadstart", tileLoadStart);
                    source.on("tileloadend", tileLoadEnd, event.context.canvas);
                    source.on("tileloaderror", tileLoadEnd, event.context.canvas);
                });

                map.setSize([width, height]);
                map.getView().fit(extent);
                map.renderSync();
            },
            false
        );


        /*****Rotate Map******/
        var rotateIndex = [-4.725660433524355, -3.1374249228564333, -1.6101493759315917, 0];
        var j = 0;
        $("#rotate").click(function () {
            map.getView().setRotation(rotateIndex[j]);
            j++;
            if (j == 4) {
                j = 0;
            }
        });

        /****Overview control******/
        var overViewControl = new ol.control.OverviewMap();
        var overviewstatus = 0;
        $("#overview").click(function () {
            if (overviewstatus == 0) {
                map.addControl(overViewControl)
                $("button[title='Overview map']").trigger('click');
                overviewstatus = 1;
            } else {
                map.removeControl(overViewControl);
                overviewstatus = 0;
            }

        });

        map.on('singleclick', function (evt) {
            var feature = map.forEachFeatureAtPixel(evt.pixel, function (feature) {
                return feature;
            });
            if (feature) {
                var properties = feature.getProperties().features[0].N;
                content.innerHTML = "<div><div class='heading'><strong>Rust Detail</strong></div><div style='padding:10px;'><table><tr><th>Severity</th><td>" + properties.severity + "</td></tr><tr><th>Disease</th><td>" + properties.disease + "</td></tr><tr><th>Groth Stage</th><td>" + properties.growth + "</td></tr><tr><th>Rust Percentage</th><td>" + properties.rush_per + "</td></tr></table></div></div>";
                overlay.setPosition(evt.coordinate);
            } else {
                var viewResolution = /** @type {number} */ (map.getView().getResolution());
                var coordinate = ol.proj.toLonLat(evt.coordinate);
                var url = wmsSource.getGetFeatureInfoUrl(
                    evt.coordinate,
                    viewResolution,
                    "EPSG:3857",
                    "EPSG:4326",
                    { INFO_FORMAT: "text/xml" }
                );


                if (url) {
                    var x = new XMLHttpRequest();
                    x.open("GET", url, true);
                    x.send();
                    x.onreadystatechange = function () {
                        if (x.readyState == 4 && x.status == 200) {
                            var num;
                            var resultArr = x.responseText.split("\n");
                            if (resultArr[3].split("=")[0] == 'Deposition') {
                                popupTitle = 'Rust Spore Deposition';
                            } else {
                                popupTitle = 'Rust Environment Suitability';
                            }
                            // popupTitle = 'Stripe rust spore ' + head;
                            popupTemplate = '';
                            if (resultArr[3].split("=")[0] == 'Deposition ') {
                                // console.log(Number(resultArr[3].split("=")[1]))
                                var vall = Number(resultArr[3].split("=")[1]);
                                var exponent = Math.round(vall).toString().length - 1
                                var val = (vall / Math.pow(10, exponent)).toFixed(3)
                                var num = val + ' x 10^' + exponent + ' per m^2'
                                // console.log(stringMsg)
                                // if (parseInt(resultArr[3].split("=")[1]) == 0) {
                                //     num = 0;
                                // } else {
                                //     var val = parseFloat(resultArr[3].split("=")[1].split("E")[0]).toFixed(3);
                                //     var expo = parseInt(resultArr[3].split("=")[1].split("E")[1]);
                                //     // console.log(resultArr[3])
                                //     // console.log(val, expo);                          
                                //     var num = val * Math.pow(10, expo);
                                //     var num = num.toExponential();
                                //     // console.log(num.toExponential())
                                // }
                                // num = Number((val * Math.pow(10,power)).toFixed(3).toString().substring(0, 3)).toFixed(2) + ' per m<sup>2</sup>';
                                popupTemplate += '<tr><td><strong>Number of spores</strong></td><td>' + num + '</td></tr><tr><td><strong>Category</strong></td><td>' + resultArr[4].split("=")[1] + '</td></tr>';

                            } else {
                                num = parseInt(resultArr[3].split("=")[1]).toFixed(2) + '%';
                                popupTemplate += '<tr><td><strong>Infection efficency</strong></td><td>' + num + '</td></tr><tr><td>Category</td><td>' + resultArr[4].split("=")[1] + '</td></tr>';
                            }


                            var popupContent = "<div><div class='heading'>" + popupTitle + "</div><div style='padding:10px;'><table>" + popupTemplate + "</table></div></div>";
                            content.innerHTML = popupContent;
                            overlay.setPosition(evt.coordinate);
                        } else {
                            overlay.setPosition(undefined)
                            closer.blur();
                        }
                    }
                }
            }

        });

        //Enable or disable spatial tools icon and filter option upon timeline view
        function setIconMode(status) {
            if (status == 0) {
                $('.rightsec a').each(function () {
                    $(this).addClass('disabled');
                });
                $('#rustType').attr('disabled', true);
                $('input[name="layerType"]').each(function () {
                    $(this).attr('disabled', true);
                });

                $('.depositionChkBox').each(function () {
                    $(this).attr('disabled', true);
                });

                $('.environmentChkBox').each(function () {
                    $(this).attr('disabled', true);
                });
            } else {
                $('.rightsec a').each(function () {
                    $(this).removeClass('disabled');
                });

                $('#rustType').attr('disabled', false);
                $('input[name="layerType"]').each(function () {
                    $(this).attr('disabled', false);
                });

                $('.depositionChkBox').each(function () {
                    $(this).attr('disabled', false);
                });

                $('.environmentChkBox').each(function () {
                    $(this).attr('disabled', false);
                });
            }
        }

        /****Printin map section start ***/
        var element = $('#map'); // global variable
        var element2 = $('.mapPngContainer');
        var getCanvas; // global variable
        var newData;
        $("#printmodal").on("shown.bs.modal", function () {
            html2canvas(element, {
                onrendered: function (canvas) {
                    $(".mapPng").html(canvas);
                    var imageData = canvas.toDataURL("image/png");
                    // Now browser starts downloading it instead of just showing it
                    newData = imageData.replace(/^data:image\/png/, "data:application/octet-stream");
                    prepareImage();
                }
            });

            if ($("#Deposition").is(":checked")) {
                $(".legendList1").html("None/Trace (0 - 10)");
                $(".legendList2").html("Low (10 - 1e+6)");
                $(".legendList3").html("Moderate (1e+6 - 1e+8)");
                $(".legendList4").html("High (1e+8 - 1e+11)");
                $(".legendList5").html("Very High (1e+11 -)");
            }else{
                $(".legendList1").html("None/Trace (0%)");
                $(".legendList2").html("Low (0% - 10.5%)");
                $(".legendList3").html("Moderate (10.5% - 21%)");
                $(".legendList4").html("High (21% - 31.5%)");
                $(".legendList5").html("Very High (31.5% - 42.1%)");
            }
        });

        function prepareImage() {
            html2canvas(element2, {
                onrendered: function (canvas) {
                    // $(".mapPng").html(canvas);
                    var imageData2 = canvas.toDataURL("image/png");
                    // Now browser starts downloading it instead of just showing it
                    var newData2 = imageData2.replace(/^data:image\/png/, "data:application/octet-stream");
                    var cdate = new Date();
                    var imgName = "WRSIS_" + cdate.getDate() + "" + (cdate.getMonth() + 1) + "" + cdate.getFullYear() + "" + cdate.getHours() + "" + cdate.getMinutes() + "" + cdate.getSeconds() + ".png";
                    $("#downloadMap").attr("download", imgName).attr("href", newData2);
                }
            });
        }

        /****Printin map section end**/

        /***Drawing Line Section Starts***/
        var drawMark;
        var drawMode = 0;

        var drawingLayer = new ol.layer.Vector({
            source: null,
            style: new ol.style.Style({
                fill: new ol.style.Fill({
                    color: '#0712b0',
                }),
                stroke: new ol.style.Stroke({
                    color: '#0712b0',
                    width: 4
                })
            })
        });
        $("#drawMark").click(function () {
            if (drawMode == 0) {
                drawMode = 1;
                var drawingSource = new ol.source.Vector({ wrapX: false });
                drawingLayer.setSource(null);
                drawingLayer.setSource(drawingSource);
                map.addLayer(drawingLayer)
                drawMark = new ol.interaction.Draw({
                    source: drawingSource,
                    type: 'LineString',
                    freehand: true
                });
                map.addInteraction(drawMark);
            } else {
                drawMode = 0;
                map.removeInteraction(drawMark);
                map.removeLayer(drawingLayer);
            }
        });
        /***Drawing Line Section Ends***/

        $("#baseMap, #draw, #drawMark, #overview").click(function () {
            $(this).toggleClass("activeIcon");
        });







        var resObjHistory = [
            {
                slno: "001",
                layerType: 'deposition',
                rustType: 'leafRust',
                wsName: "WRSIS_2020_deposition_leafRust",
                layerName: "WRSIS_2020_deposition_leafRust_w1",
                createdOn: "08 March 2020"
            },
            {
                slno: "004",
                layerType: 'environment',
                rustType: 'leafRust',
                wsName: "WRSIS_2020_environment_leafRust",
                layerName: "WRSIS_2020_environment_leafRust_w1",
                createdOn: "08 March 2020"
            },
            {
                slno: "002",
                layerType: 'deposition',
                rustType: 'steamRust',
                wsName: "WRSIS_2020_deposition_steamRust",
                layerName: "WRSIS_2020_deposition_steamRust_w1",
                createdOn: "08 March 2020"
            },
            {
                slno: "005",
                layerType: 'environment',
                rustType: 'steamRust',
                wsName: "WRSIS_2020_environment_steamRust",
                layerName: "WRSIS_2020_environment_steamRust_w1",
                createdOn: "08 March 2020"
            },
            {
                slno: "003",
                layerType: 'deposition',
                rustType: 'yellowRust',
                wsName: "WRSIS_2020_deposition_yellowRust",
                layerName: "WRSIS_2020_deposition_yellowRust_w1",
                createdOn: "08 March 2020"
            },
            {
                slno: "006",
                layerType: 'environment',
                rustType: 'yellowRust',
                wsName: "WRSIS_2020_environment_yellowRust",
                layerName: "WRSIS_2020_environment_yellowRust_w1",
                createdOn: "08 March 2020"
            }
        ];

        var resObj = [
            {
                slno: "001",
                layerType: 'deposition',
                rustType: 'leafRust',
                wsName: "WRSIS_2020_deposition_leafRust",
                layerName: "WRSIS_2020_deposition_leafRust_w1",
                createdOn: "08 March 2020"
            },
            {
                slno: "002",
                layerType: 'deposition',
                rustType: 'steamRust',
                wsName: "WRSIS_2020_deposition_steamRust",
                layerName: "WRSIS_2020_deposition_steamRust_w1",
                createdOn: "08 March 2020"
            },
            {
                slno: "003",
                layerType: 'deposition',
                rustType: 'yellowRust',
                wsName: "WRSIS_2020_deposition_yellowRust",
                layerName: "WRSIS_2020_deposition_yellowRust_w1",
                createdOn: "08 March 2020"
            },
            {
                slno: "004",
                layerType: 'environment',
                rustType: 'leafRust',
                wsName: "WRSIS_2020_environment_leafRust",
                layerName: "WRSIS_2020_environment_leafRust_w1",
                createdOn: "08 March 2020"
            },
            {
                slno: "005",
                layerType: 'environment',
                rustType: 'steamRust',
                wsName: "WRSIS_2020_environment_steamRust",
                layerName: "WRSIS_2020_environment_steamRust_w1",
                createdOn: "08 March 2020"
            },
            {
                slno: "006",
                layerType: 'environment',
                rustType: 'yellowRust',
                wsName: "WRSIS_2020_environment_yellowRust",
                layerName: "WRSIS_2020_environment_yellowRust_w1",
                createdOn: "08 March 2020"
            }
        ];



    </script>
</body>

</html>